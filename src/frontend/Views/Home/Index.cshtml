@{
    ViewData["Title"] = "Home";
}

<div class="page-shell">
    <section class="login-layout" id="loginView">
        <div class="login-stack">
            <p class="login-year">2026 New Devices Lab</p>

            <section class="login-panel">
                <div class="panel-head">
                    <p class="kicker">Sign in</p>
                    <h2>Welcome back</h2>
                    <p class="muted">Use your username or your Radboud email.</p>
                </div>

                <form id="loginForm" class="form-stack">
                    <label>
                        Username or email
                        <input type="text" name="identifier" autocomplete="username" required />
                    </label>
                    <label>
                        Password
                        <input type="password" name="password" autocomplete="current-password" required />
                    </label>
                    <label class="checkbox-inline">
                        <input type="checkbox" name="rememberMe" />
                        <span>Keep me signed in</span>
                    </label>
                    <button type="submit" class="primary-button">Login</button>
                    <p class="form-message" id="loginMessage"></p>
                </form>
            </section>

            <section class="login-brand">
                <h1>New Devices Lab Portal</h1>
            </section>
        </div>
    </section>

    <div class="workspace-shell hidden" id="appView">
        <aside class="sidebar">
            <div class="sidebar-brand">
                <div class="brand-badge brand-badge-small">NDL</div>
                <div>
                    <p class="kicker">Workspace</p>
                    <h2>New Devices Lab</h2>
                </div>
            </div>

            <nav class="sidebar-nav">
                <button type="button" class="nav-link is-active" data-section-target="projectsSection">Projects</button>
                <button type="button" class="nav-link" data-section-target="accessSection">My Access</button>
            </nav>

            <div class="sidebar-account">
                <button type="button" class="account-trigger" id="accountMenuButton">
                    <span class="account-avatar" id="accountInitials">U</span>
                    <span class="account-copy">
                        <strong id="currentUserName">User</strong>
                        <span id="currentUserMeta">Account</span>
                    </span>
                </button>

                <div class="account-menu hidden" id="accountMenuPanel">
                    <button type="button" class="menu-link" id="profileMenuButton">My profile</button>
                    <button type="button" class="menu-link hidden" id="accountAdminButton">Admin</button>
                    <button type="button" class="menu-link danger" id="logoutButton">Logout</button>
                </div>
            </div>
        </aside>

        <main class="workspace-main">
            <section class="topbar">
                <div>
                    <h1 class="page-title" id="homeTitle">Projects</h1>
                    <p class="muted" id="homeCopy">Your workspace, project overview, and access details.</p>
                </div>
                <div class="topbar-actions">
                    <label class="search-shell">
                        <span>Search</span>
                        <input type="search" placeholder="Search projects..." />
                    </label>
                    <button type="button" class="primary-button" id="openProjectModalButton">Create New Project</button>
                </div>
            </section>

            <section class="hero-strip">
                <article class="hero-card">
                    <span class="metric-label">Groups</span>
                    <strong class="metric-value" id="groupCount">0</strong>
                </article>
                <article class="hero-card">
                    <span class="metric-label">Permissions</span>
                    <strong class="metric-value" id="permissionCount">0</strong>
                </article>
                <article class="hero-card hidden" id="adminHeroCard">
                    <span class="metric-label">Admin Access</span>
                    <strong class="metric-value">Enabled</strong>
                </article>
            </section>

            <section class="projects-section" id="projectsSection">
                <div class="section-head">
                    <div>
                        <p class="kicker">Projects</p>
                        <h3>Your workspace</h3>
                    </div>
                    <span class="muted" id="projectAccessHint">Your project access is based on your permissions and memberships.</span>
                </div>

                <div class="project-board">
                    <section class="card">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Project list</p>
                                <h4>Visible projects</h4>
                            </div>
                        </div>
                        <div class="stack-list" id="projectsList">
                            <p class="muted">Loading projects...</p>
                        </div>
                    </section>

                    <section class="card card-tall">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Project details</p>
                                <h4 id="selectedProjectName">Select a project</h4>
                            </div>
                            <span class="status-pill" id="selectedProjectStatus">Idle</span>
                        </div>

                        <div class="detail-stack">
                            <p class="muted" id="selectedProjectIdea">Pick a project to view the team, idea, and orders.</p>
                            <p class="detail-copy" id="selectedProjectDescription"></p>
                            <p class="muted" id="selectedProjectMeta"></p>

                            <section class="detail-block">
                                <h4>Members</h4>
                                <div class="chip-list" id="selectedProjectMembers"></div>
                            </section>

                            <section class="detail-block hidden" id="statusEditorSection">
                                <h4>Project status</h4>
                                <div class="inline-composer">
                                    <select id="projectStatusSelect">
                                        <option>Draft</option>
                                        <option>Active</option>
                                        <option>Review</option>
                                        <option>Completed</option>
                                        <option>Paused</option>
                                    </select>
                                    <button type="button" class="secondary-button" id="saveProjectStatusButton">Save status</button>
                                </div>
                                <p class="form-message" id="projectStatusMessage"></p>
                            </section>

                            <section class="detail-block">
                                <div class="section-head compact">
                                    <div>
                                        <h4>Order sheets</h4>
                                    </div>
                                </div>
                                <div class="stack-list" id="selectedProjectOrderSheets">
                                    <p class="muted">No project selected yet.</p>
                                </div>
                            </section>

                            <section class="detail-block hidden" id="orderSheetSection">
                                <div class="section-head compact">
                                    <div>
                                        <h4>Create order sheet</h4>
                                    </div>
                                </div>
                                <form id="orderSheetForm" class="form-stack">
                                    <div class="order-items-stack" id="orderSheetItems">
                                        <div class="order-item-grid">
                                            <input type="text" name="siteName" placeholder="Site name" required />
                                            <input type="text" name="componentName" placeholder="Component name" required />
                                            <input type="text" name="brand" placeholder="Brand" required />
                                            <input type="url" name="link" placeholder="Link" required />
                                            <input type="number" name="priceEuro" min="0.01" step="0.01" placeholder="Price in euro" required />
                                        </div>
                                    </div>
                                    <div class="inline-composer">
                                        <button type="button" class="secondary-button" id="addOrderItemButton">Add another item</button>
                                        <label class="checkbox-inline compact-checkbox">
                                            <input type="checkbox" name="submitNow" />
                                            <span>Submit now</span>
                                        </label>
                                    </div>
                                    <button type="submit" class="primary-button">Save order sheet</button>
                                    <p class="form-message" id="orderSheetMessage"></p>
                                </form>
                            </section>
                        </div>
                    </section>
                </div>

                <div class="project-grid" id="accessSection">
                    <article class="project-card">
                        <div class="project-card-head">
                            <span class="status-pill">Access</span>
                        </div>
                        <h4>Your groups</h4>
                        <div class="chip-list" id="userGroups"></div>
                    </article>

                    <article class="project-card">
                        <div class="project-card-head">
                            <span class="status-pill">Permissions</span>
                        </div>
                        <h4>Your permissions</h4>
                        <div class="chip-list" id="userPermissions"></div>
                    </article>

                    <article class="project-card project-card-featured">
                        <div class="project-card-head">
                            <span class="status-pill status-live">Create</span>
                        </div>
                        <h4>Start a new project</h4>
                        <p>Create a project, invite other students by email, and keep the idea and description organized in one place.</p>
                        <button type="button" class="secondary-button" id="openProjectModalButtonAlt">Open project form</button>
                    </article>
                </div>
            </section>

            <section class="admin-section hidden" id="adminSection">
                <div class="section-head">
                    <div>
                        <p class="kicker">Administration</p>
                        <h3>Manage people, groups, and permissions</h3>
                    </div>
                </div>

                <div class="stats-row">
                    <article class="stat-card">
                        <span class="metric-label">Users</span>
                        <strong class="metric-value" id="usersStat">0</strong>
                    </article>
                    <article class="stat-card">
                        <span class="metric-label">Groups</span>
                        <strong class="metric-value" id="groupsStat">0</strong>
                    </article>
                    <article class="stat-card">
                        <span class="metric-label">Permissions</span>
                        <strong class="metric-value" id="permissionsStat">0</strong>
                    </article>
                </div>

                <div class="admin-grid">
                    <section class="card card-tall">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Users</p>
                                <h4>User list</h4>
                            </div>
                        </div>
                        <div class="stack-list" id="usersList">
                            <p class="muted">Loading users...</p>
                        </div>
                    </section>

                    <section class="card">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Create</p>
                                <h4>Add user</h4>
                            </div>
                        </div>
                        <form id="createUserForm" class="form-stack">
                            <label>
                                Radboud Email
                                <input type="email" name="radboudEmail" required />
                            </label>
                            <label>
                                Username
                                <input type="text" name="username" required />
                            </label>
                            <label>
                                Password
                                <input type="password" name="password" minlength="12" required />
                            </label>
                            <label>
                                Student Number
                                <input type="text" name="studentNumber" required />
                            </label>
                            <label>
                                Enrollment Date
                                <input type="date" name="enrollmentDate" required />
                            </label>
                            <fieldset>
                                <legend>Groups</legend>
                                <div class="checkbox-list" id="createGroupOptions"></div>
                            </fieldset>
                            <button type="submit" class="primary-button">Create user</button>
                            <p class="form-message" id="createUserMessage"></p>
                        </form>
                    </section>
                </div>

                <div class="admin-grid">
                    <section class="card">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Memberships</p>
                                <h4>Assign groups</h4>
                            </div>
                        </div>
                        <form id="membershipForm" class="form-stack">
                            <label>
                                User
                                <select id="membershipUserSelect" name="userId"></select>
                            </label>
                            <fieldset>
                                <legend>Groups</legend>
                                <div class="checkbox-list" id="membershipGroupOptions"></div>
                            </fieldset>
                            <button type="submit" class="primary-button">Save memberships</button>
                            <p class="form-message" id="membershipMessage"></p>
                        </form>
                    </section>

                    <section class="card">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Permissions</p>
                                <h4>Group permissions</h4>
                            </div>
                        </div>
                        <form id="groupPermissionForm" class="form-stack">
                            <label>
                                Group
                                <select id="groupPermissionSelect" name="groupId"></select>
                            </label>
                            <fieldset>
                                <legend>Permissions</legend>
                                <div class="checkbox-list long-list" id="permissionOptions"></div>
                            </fieldset>
                            <button type="submit" class="primary-button">Save permissions</button>
                            <p class="form-message" id="groupPermissionMessage"></p>
                        </form>
                    </section>
                </div>

                <div class="admin-grid">
                    <section class="card">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Groups</p>
                                <h4>Overview</h4>
                            </div>
                        </div>
                        <div class="stack-list" id="groupsList">
                            <p class="muted">Loading groups...</p>
                        </div>
                    </section>

                    <section class="card">
                        <div class="section-head compact">
                            <div>
                                <p class="kicker">Permissions</p>
                                <h4>Catalog</h4>
                            </div>
                        </div>
                        <div class="chip-list" id="permissionsList">
                            <p class="muted">Loading permissions...</p>
                        </div>
                    </section>
                </div>
            </section>
        </main>
    </div>

    <div class="overlay hidden" id="overlay"></div>

    <section class="side-panel hidden" id="profilePanel">
        <div class="section-head">
            <div>
                <p class="kicker">My profile</p>
                <h3>Account settings</h3>
            </div>
            <button type="button" class="icon-button" id="closeProfileButton" aria-label="Close profile panel">×</button>
        </div>

        <form id="profileForm" class="form-stack">
            <label>
                Radboud Email
                <input type="email" id="profileEmail" disabled />
            </label>
            <label>
                Username
                <input type="text" name="username" id="profileUsername" required />
            </label>
            <button type="submit" class="primary-button">Save profile</button>
            <p class="form-message" id="profileMessage"></p>
        </form>

        <div class="divider"></div>

        <form id="passwordForm" class="form-stack">
            <div class="section-head compact">
                <div>
                    <p class="kicker">Security</p>
                    <h4>Change password</h4>
                </div>
            </div>
            <label>
                Current password
                <input type="password" name="currentPassword" autocomplete="current-password" required />
            </label>
            <label>
                New password
                <input type="password" name="newPassword" autocomplete="new-password" minlength="12" required />
            </label>
            <button type="submit" class="primary-button">Update password</button>
            <p class="form-message" id="passwordMessage"></p>
        </form>
    </section>

    <section class="modal-shell hidden" id="projectModal">
        <div class="modal-card">
            <div class="section-head">
                <div>
                    <p class="kicker">Projects</p>
                    <h3>Create New Project</h3>
                    <p class="muted">The backend is next. This screen now matches the product direction.</p>
                </div>
                <button type="button" class="icon-button" id="closeProjectModalButton" aria-label="Close project form">×</button>
            </div>

            <form id="projectPreviewForm" class="form-stack">
                <label>
                    Project Name
                    <input type="text" name="name" placeholder="e.g. Prototype-X Sensor Node" />
                </label>
                <label>
                    Project Idea
                    <input type="text" name="idea" placeholder="Short one-line idea" />
                </label>
                <label>
                    Description
                    <textarea rows="4" name="description" placeholder="Briefly describe the idea, objective, and lab setup."></textarea>
                </label>
                <label>
                    Invite team by email
                    <input type="text" name="memberEmails" placeholder="student1@ru.nl, student2@ru.nl" />
                </label>
                <div class="modal-actions">
                    <button type="button" class="secondary-button" id="cancelProjectModalButton">Cancel</button>
                    <button type="submit" class="primary-button">Initialize Project</button>
                </div>
                <p class="form-message" id="projectMessage"></p>
            </form>
        </div>
    </section>
</div>
